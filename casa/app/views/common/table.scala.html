@(claimList:Option[play.api.libs.json.JsArray], currentDate:org.joda.time.LocalDate, currentStatus: String)

@import helper._
@import org.joda.time.format.DateTimeFormat
@import org.joda.time.DateTime
@import utils.JsValueWrapper.improveJsValue

@dateTime(date:DateTime) = @{ DateTimeFormat.forPattern("dd/MM/yyyy, HH:mm").print(date) }
@date(date:DateTime) = @{ DateTimeFormat.forPattern("dd/MM/yyyy").print(date) }
@currentDateToHiddenValue = @{ DateTimeFormat.forPattern("ddMMyyyy").print(currentDate)}
@isStatusCompleted = @{ currentStatus == "completed"}

@form(action = controllers.routes.Application.complete(currentDateToHiddenValue)){
    <table id="claimsTable" class="tablesorter">
        <caption>List of claims</caption>
        <thead>
            <tr>
                <th></th>
                <th id="thTransactionId">Transaction Id</th>
                <th id="thNameId" class="view">Name</th>
                <th class="ni">NI Number</th>
                <th>Claim type</th>
                <th class="view">Submit Date</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            @if(!isStatusCompleted){
                <div class="actions">
                    <button type="submit" class="active" id="completeButton1" >Complete</button>
                </div>
            }
            @if(claimList.isDefined){
                @for((claim,i) <- claimList.get.value.zipWithIndex){
                    <tr id="row_@claim.p.transactionId">
                        <td>
                        @if(claim.p.status.asString == "viewed") {
                            <label for="@claim.p.transactionId">Claim</label><input type="checkbox" name="completedCheckboxes[@i]" id="@claim.p.transactionId" value="@claim.p.transactionId">
                        }
                        </td>
                        <td id="transactionId" class="transactionId"><a href="/render/@claim.p.transactionId" target="@claim.p.transactionId">@claim.p.transactionId</a></td>
                        <td id="name" class="name view">@claim.p.surname @claim.p.forename</td>
                        <td id="nino" class="ni">@claim.p.nino</td>
                        <td id="claimType" class="claimtype">@claim.p.claimType</td>
                        <td id="claimDate" class="view">@dateTime(claim.p.claimDateTime.asDate)</td>

                        <td class="status">@claim.p.status</td>
                    </tr>
                }
            }
        </tbody>
    </table>

	<div class="actions below">
        <a class="active" id="exportButton" href="@{controllers.routes.Application.export.url}" >Export</a>
        @if(!isStatusCompleted){
        	<button type="submit" class="active" id="completeButton2" >Complete</button>
		}
    </div>
}
    
